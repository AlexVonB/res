!function(t){"use strict";t.res=function(e,r){function n(t){this.start=t.start||null,this.count=t.count||null,this.usercontext=[],this.controllercontext=[],this.props=[]}function o(t){this.ref=t}e=/\/$/.exec(e)?e:e+"/";var s={password:null,username:null},a=t.extend({},s,r);return n.prototype.addUsercontext=function(t,e){return this.usercontext.push({name:t,value:e}),this},n.prototype.addControllercontext=function(t,e){return this.controllercontext.push({name:t,value:e}),this},n.prototype.addProp=function(t,e,r){return this.props.push({name:t,value:e,descs:r||[]}),this},n.prototype.toXMLString=function(){var e=t("<query></query>");if(null!==this.start&&e.attr("start",this.start),null!==this.count&&e.attr("count",this.count),this.usercontext.length>0){for(var r=t("<usercontext></usercontext>"),n=0;n<this.usercontext.length;n++){var o=t("<prop />").attr("name",this.usercontext[n].name).attr("val",this.usercontext[n].value);r.append(o)}e.append(r)}if(this.controllercontext.length>0){for(var r=t("<controllercontext></controllercontext>"),n=0;n<this.controllercontext.length;n++){var o=t("<prop>").attr("name",this.controllercontext[n].name).attr("val",this.controllercontext[n].value);r.append(o)}e.append(r)}if(this.props.length>0)for(var n=0;n<this.props.length;n++){for(var o=t("<prop>").attr("name",this.props[n].name).attr("val",this.props[n].value),s=0;s<this.props[n].descs.length;s++){var a=t("<descriptor>").attr("name",this.props[n].descs[s].name).attr("val",this.props[n].descs[s].value);o.append(a)}e.append(o)}return(new XMLSerializer).serializeToString(e[0])},o.prototype.toXMLString=function(){var e=t("<query>").attr("ref",this.ref);return(new XMLSerializer).serializeToString(e[0])},{query:function(r){var n=t.Deferred();return console.log(r),t.ajax({url:e+"query",contentType:"text/xml",crossDomain:!0,data:r,dataType:"xml",method:"POST",password:a.password,processData:!1,username:a.username}).done(function(e){n.resolve(t(e))}).fail(function(t,e,r){n.reject(t,e,r)}),n},Query:function(t){return new n(t)},Ref:function(t){return new o(t)}}}}(jQuery);